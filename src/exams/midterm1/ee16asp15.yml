course: 'ee16a'
ref: 'mt1-sp15'

type: 'Midterm 1'
term: 'Spring 2015'
prof: 'Alon, Ayazifar, Subramanian'

questions: {
  'q1': 'Imaging Circuit',
  'q2': 'Sparse Images and Vector Geometry',
  'q3': 'Coding for Storage',
  'q4': 'Investment Strategy',
  'q5': 'Berkeley Forever'
}

parts: {
  'q1': 3,
  'q2': 3,
  'q3': 4,
  'q4': 2,
  'q5': 3,
}

pre: |
  <div class="content-spacer"></div>

q1_1: |
  <h3>PROBLEM 1. Imaging Circuit <i>(12 points)</i></h3>
  In this problem we will return one final time to examining how one might choose the area of a photodetector in order to maximize the measured voltage. This time however, let’s assume that light shines only over a fixed area $A_{illuminated}$.<br/><br/>

  (Recall that in the rain analogy, the area of the photodetector is analogous to the area of the bucket, the current is analogous to the amount of water per unit time being captured in the bucket, and the voltage is analogous to the height of the water accumulated within the bucket.)<br/><br/>

  (a) <i>(3 pts)</i> Let’s assume that the area of the photodetector is $A_{PD}$, that $A_{PD}$ is smaller than $A_{illuminated}$, and that the photodetector is placed such that it fits entirely within the illuminated region. In this case, can you predict how the current produced by the photodetector $I_{PD}$ would change as a function of $A_{PD}$ and $A_{illuminated}$?

q1_1_s: |
  In this case, increasing $A_{PD}$ captures more light (photons), so:
  <hr class="s1" />
  $$I_{PD} \propto \frac{A_{PD}}{A_{illuminated}}$$
  <hr class="s1" />
  (Note that answers with $I_{PD} \propto A_{PD}$ will receive full credit as well)

q1_2: |
  (b) <i>(3 pts)</i> Now let’s assume that $A_{PD}$ is larger than $A_{illuminated}$ and that the illuminated area is fully captured by the photodetector; how does the current $I_{PD}$ depend upon on $A_{PD}$ now?

q1_2_s: |
  Now increasing $A_{PD}$ does nothing to change the amount of light that is captured, so:
  $$I_{PD} \propto constant$$

q1_3: |
  c) <i>(6 pts)</i> Let’s now assume that in order to read out its voltage, we have to connect 
  the photodetector device to a circuit with a fixed capacitance, and that we operate 
  the photodetector the same way as we did in homework 0. In other words, before 
  each measurement, we discharge both the photodetector and the measurement 
  circuit (note that you can think of the capacitance of the readout circuit as being 
  the measurement bucket from homework 0; remember that the measurement 
  bucket is not exposed directly to the rain), let the photodetector charge up over a 
  period of time, and then connect it to the readout circuit.<br/><br/>
   
  Given your answers to part a) and b), what should you set $A_{PD}$ equal to in order to 
  maximize the measured voltage? Be sure to explain your answer; some equations 
  and/or plots showing how the voltage depends on $A_{PD}$ and $A_{illuminated}$ may be useful. 

q1_3_s: |
  Just like in the homework, some of the charge collected by the photodetector has to go in to the measurement circuits capacitance. Conceptually, if that circuit had an equivalent area (remember $capacitance \propto area$ of $A_{meas}$, then for $A_{PD} < A_{illuminated}$:

  $$V_{meas} \propto \frac{1}{A_{PD} + A_{meas}} \cdot \frac{A_{PD}}{A_{illuminated}}$$

  However, increasing $A_{PD}$ above $A_{illuminated}$ doesn't give us any more charge (since $I_PD$ is now fixed). So if $A_{PD} > A_{illuminated}$:

  $$V_{meas} \propto \frac{A_{illuminated}}{A_{PD} + A_{meas}}$$

  Putting these together, the point at which we get maximum $V_{meas}$ is for $A_{PD} = A_{illuminated}$; this choice gives us the maximum charge we can get with the smallest total capacitance.

  <hr class="s2"/>

  For completeness, if you plot $V_{meas}$ vs $A_{PD}$, it should look like:

  <img src="/img/sp15q1_s.png" class="problem-image" />

q2_1: |
  <h3>PROBLEM 2. Sparse Images and Vector Geometry <i>(14 pts)</i></h3>
   
  So far we've usually represented images as data grids. However, sometimes this can be 
  very expensive in cases where most of the image pixels are exactly identical.
  example, consider a 5 X 5 image where all the pixels are white, except for the pixel 
  position $\left[ \begin{array}{c c} 2 & 3 \\ \end{array} \right]$ which is black. Such an image is called a "sparse" image, and it may be much more efficient to represent it by only specifying the location(s) of the white pixel(s).<br/><br/>
   
  For example, if we had a 2 x 2 image with a white background, an image comprised of 
  the vector ${\left[ \begin{array}{c c} x & y \\ \end{array} \right]}^T = {\left[ \begin{array}{c c} 0 & 1 \\ \end{array} \right]}^T$ would have a black pixel in the upper left hand corner of the image. (In other words, in this encoding the vectors correspond to positions in ${\left[ \begin{array}{c c} 0 & 0 \\ \end{array} \right]}^T$ is the origin.) This particular image is shown below. Note that for the rest of the problem, when we ask you to draw an image, rather than you filling in each pixel, we will just be asking you to draw an X at the positions indicated by each vector – this is depicted on the right for the example image.   

  <img src="/img/sp15q2-1.png" className="problem-image" /> 

  a) <i>(2 pts)</i> Using the same representation as the example described above, draw the image represented by the vector $\left[ \begin{array}{c} 1 \\ 2 \\ \end{array} \right]$.

q2_1_s: |
  <img src="/img/sp15q2-1_s.png" class="problem-image" />

q2_2: |
  b) <i>(6 pts)</i> Now let’s examine what happens if we have an image with two black 
  pixels and perform a transformation on this image. In particular, let’s assume that 
  our image consists of the vectors $\left[ \begin{array}{c} 1 \\ 2 \\ \end{array} \right]$ and $\left[ \begin{array}{c} 1 \\ 1 \end{array} \right]$. Draw both the original image and the image created by transforming that image by the matrix $\left[ \begin{array}{c c} 1 & 2 \\ 2 & 4 \end{array} \right]$. (Recall that transformation in this context means multiplying each vector by the given matrix.)

q2_2_s: |
  <img src="/img/sp15q2-2_s.png" class="problem-image" />

  $$\left[ \begin{array}{c c}1 & 2 \\ 2 & 4 \\ \end{array} \right] \cdot \left[ \begin{array}{c} 1 \\ 2 \\ \end{array} \right] = \left[ \begin{array}{c} 5 \\ 10 \\ \end{array} \right]$$

  $$\left[ \begin{array}{c c}1 & 2 \\ 2 & 4 \\ \end{array} \right] \cdot \left[ \begin{array}{c} 1 \\ 1 \\ \end{array} \right] = \left[ \begin{array}{c} 3 \\ 6 \\ \end{array} \right]$$

q2c: |
  c) <i>(6 pts)</i> Now let’s imagine we had an image with black pixels everywhere, and that we transformed this image by the same $\left[ \begin{array} [[1, 2], [2, 4]] \end{array} \right]$ matrix as in part b). Sketch the that we transformed this image by the same resulting transformed image. Note that you don’t need to know the exact size of the original image – just indicate what happens to the transformed image as this size is increased. It may help you to consider what happens when you multiply an arbitrary vector $\left[ \begin{array} [['x', 'y']], true \end{array} \right]$ by the transformation matrix. What is property of the transformation matrix makes the resulting image look the way it does? 

q2_3_s: |
  Notice that after transformation both of the black pixels in part (b) ended up on a single line. We can see this in general because:
  $$\left[ \begin{array}{c c}1 & 2 \ 2 & 4 \ \end{array} \right] \left[ \begin{array}{c} x \ y \ \end{array} \right] = \left[ \begin{array}{c} x + 2y \ 2x + 4y \ \end{array} \right] = \left[ \begin{array}{c} x + 2y \ 2 \cdot (x + 2y) \ \end{array} \right] = \left[ \begin{array}{c} a_1 \ 2a_1 \ \end{array} \right]$$

  Therefore, an image with all black pixels will become a line defined by $y = 2x$:
  <hr class="s2" />

  <img src="/img/sp15q2-3_s.png" class="problem-image" />

  <hr class="s2" />
  The property of the matrix that causes this is that it is <b>non-invertible</b>.

q3_1: |
  <h3>PROBLEM 3. Coding for Storage <i>(13 points)</i></h3>
  Alice is a budding young photographer. Given the beautiful weather over the weekend 
  she goes up into the Berkeley hills and takes a bunch of gorgeous pictures of San 
  Francisco. She’s hoping to sell these pictures to make some extra money, and so she 
  wants to make sure she doesn’t lose the data. The images she captures are all square 
  images of $n$ x $n$ pixels. Each pixel contains a positive number indicating the intensity of light, and for the rest of this problem, you can assume that it takes 3 bytes of memory to store such a number.<br/><br/>

  a) <i>(2 pts)</i> Alice is known to be clumsy with her laptop and so she doesn’t want to 
  just store all the pictures in one place. Instead, she makes 3 copies of the image, 
  and stores each copy on a different USB stick. If Alice wanted to store 1000 
  images this way, where each image is 1000 x 1000 pixels (i.e., $n$ = 1000), how 
  many total bytes of memory (including all three USB sticks) would Alice need? 

q3_1_s: |
  $\begin{align} N_{bytes} &= 3 copies \cdot 1000 images \cdot (1000 \cdot 1000) pixels \cdot 3 bytes/pixel \\ &= 9 \cdot 10^9 bytes \end{align}$

q3_2: |
  b) <i>(5 pts)</i> Alice realizes that if she wants to keep taking pictures, she is going to have to become efficient with her storage, she cannot simply keep replicating the data. 
  So she focuses on first understanding how she can efficiently store two images. 
  Just like in the lab, we’ll express the images as vectors. 
   
  Consider two image vectors $x$ and $y$. Alice applies the following strategy: she 
  stores $x$ on the laptop, $y$ on the USB stick, and $x$ on her phone. Alice’s friend Elaine instead suggests that Alice use a different strategy and store $x + y$ on her 
  phone instead (while leaving the data stored on the laptop and USB the same as in Alice’s strategy). Is Elaine’s strategy better than Alice’s strategy? If so, describe at least one scenario where Elaine’s strategy can recover the data but Alice’s cannot. If not, explain why the strategies are equivalent.

q3_2_s: |
  Elaine's strategy is better; in Alice's strategy, if the USB stick is lost, Alice cannot recover $y$. With Elaine's strategy, any one of the storage devices can be lost while still recovering both $x$ and $y$.

q3_3: |
  c) <i>(6 pts)</i> Let’s now consider a more advanced storage strategy that uses 8 storage 
  devices to handle four images $a$, $b$, $c$, and $d$. If each pixel (which contains a real 
  number representing the intensity) in each of the four image vectors is $a_i$, $b_i$, $c_i$, $d_i$, 
  the information stored in each pixel location of the 8 storage devices will be $a_i$, $b_i$, 
  $c_i$, $d_i$, $a_i$+$b_i$, $c_i$+$d_i$, $a_i$
  +$c_i$, $b_i$+$d_i$. If we were to represent the storage action 
  happening on each of the pixels as an $8$x$4$ matrix multiplying a $4$x$1$ vector, what 
  would the entries in that $8$x$4$ matrix and $4$x$1$ vector be? 

q3_3_s: |
  If the stored information is a vector $S_i$:

  $$\left[ \begin{array}{c} S_{i1} \\ S_{i2} \\ \vdots \\ \vdots \\ \vdots \\ \vdots \\ \vdots \\ S_{i8} \\ \end{array} \right] = \left[ \begin{array}{c c c c} 1 & 0 & 0 & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0 \\ 0 & 0 & 0 & 1 \\ 1 & 1 & 0 & 0 \\ 0 & 0 & 1 & 1 \\ 1 & 0 & 1 & 0 \\ 0 & 1 & 0 & 1 \\ \end{array} \right] \cdot \left[ \begin{array}{c} a_i \\ b_i \\ c_i \\ d_i \\ \end{array} \right]$$

  <hr class="s1" />
  Define the binary matrix above as $A_{store}$ for part (d).

q3_4: |
  d) <i>(Bonus: 6 pts)</i> Recalling that $a$, $b$, $c$, and $d$ are all $n^2$ x $1$ vectors, show how you 
  could perform a single matrix-matrix multiplication to represent the storage action 
  of all of the pixels simultaneously. Hint: what would be the dimensions of a 
  matrix composed of ${\left[ \begin{array}{c c c c} a & b & c & d \\ \end{array} \right]}^T$?

q3_4_s: |
  $${\left[ \begin{array}{c c c c} a & b & c & d \\ \end{array} \right]}^T = \left[ \begin{array}{c} a^T \\ b^T \\ c^T \\ d^T \\ \end{array} \right]$$

  Since $A_{store}$ is an 8 x 4 matrix, we can actually multiply the matrix above by $A_{store}$ and get exactly what we wanted!

  $$\left[ \begin{array}{c} s_1^T \\ s_2^T \\ \vdots \\ s_8^T \\ \end{array} \right] = A_{store} \cdot \left[ \begin{array}{c} a^T \\ b^T \\ c^T \\ d^T \\ \end{array} \right]$$

q4_1: |
  <h3>PROBLEM 4. Investment Strategy <i>(10 pts)</i></h3>
   
  Alice finally sells some of her photographs and makes a bunch of money. In fact, she is 
  so rich that at the beginning of every day she can put \$1 of her money into the stock 
  market. At the end of the day she sells her stocks and looks at how much money she got 
  back. She decides to let a Berkeley-based mutual fund manage the \$1 she invests. This 
  mutual fund invests in three companies from the area: Friendly Faces Inc., Search and 
  Spend Inc., and Delicious Devices Inc.<br/><br/>
   
  Each company has a growth $g_f(i)$, $g_s(i)$, and $g_d(i)$ on day $i$. What this means is that if Alice 
  invests \$1 in Friendly Faces on day i, then she gets back $g_f(i)$ dollars at the end of day $i$. 
  The mutual fund invests fractions $\alpha_f$, $\alpha_s$, and $\alpha_d$ of Alice’s money in each of the three  companies; note that these fractions are always the same (i.e., they do not change from one day to the next), and that <b>all of her money is always invested in the market.</b><br/><br/>

  a) <i>(3 pts)</i> Using the terms defined above, write an expression using a dot product that would compute how many dollars Alice gets back after the first day.

q4_1_s: |
  Growth vector $\vec{g}(1) = \left[ \begin{array}{c} g_f(1) \\ g_s(1) \\ g_d(1) \\ \end{array} \right]$
  <hr class="s1" />
  Investment vector $\vec{\alpha} = \left[ \begin{array}{c} \alpha_f \\ \alpha_s \\ \alpha_d \\ \end{array} \right]$
  <hr class="s1" />
  Dollars returned after day 1: $\vec{g}(1)^T \cdot \vec{\alpha} = g_f(1)\alpha_f + g_s(1)\alpha_s + g_d(1)\alpha_d$

q4_2: |
  b) <i>(7 pts)</i> Let’s assume that on the first day, Alice got back $1.7 from her \$1 investment – i.e., the result of the expression you wrote in part a) is \$1.7. Alice is
  quite happy with the increase, and decides to continue investing.<br/><br/>
  On the second day, Alice again invests \$1 at the beginning of the day, but at the end of the day she finds out that all of her money was lost – i.e., she will be getting \$0 back!<br/><br/>
  This makes Alice angry and she wants to find out the investment strategy of the
  mutual fund. She goes back and does some research and finds that $g_f(1)$ = 2,
  $g_s(1)$ = 1, and $g_d(1)$ = 2, and on the second day $g_f(2)$ = 2, $g_s(2)$ = 2, but $g_d(2)$ = -3.<br/><br/>
  Write a matrix equation Alice could use to figure out what the mutual fund’s
  investment strategy was (i.e., to find the values of $\alpha_f$, $\alpha_s$, and $\alpha_d$).

q4_2_s: |
  <ul>
  <li>
  We know that $\vec{g}(1)^T \cdot \vec{\alpha} = 1.7$, and that $\vec{g}(2)^T \cdot \vec{\alpha} = 0$. This however gives us only two equations with 3 unknowns. To get a third equation, we need to remember that $\alpha_f + \alpha_s + \alpha_d = 1$ (i.e., that all of Alice's money is invested).
  </li>
  <li>
  Writing this in matrix form:
  $$\left[ \begin{array}{c c c} 2 & 1 & 2 \\ 2 & 2 & -3 \\ 1 & 1 & 1 \\ \end{array} \right] \left[ \begin{array}{c} \alpha_f \\ \alpha_s \\ \alpha_d \\ \end{array} \right] = \left[ \begin{array}{c} 1.7 \\ 0 \\ 1 \\ \end{array} \right]$$
  </li>
  <li>
  So, assuming the matrix above is invertible (which it is):
  $$\left[ \begin{array}{c} \alpha_f \\ \alpha_s \\ \alpha_d \\ \end{array} \right] = {\left[ \begin{array}{c c c} 2 & 1 & 2 \\ 2 & 2 & -3 \\ 1 & 1 & 1 \\ \end{array} \right]}^{-1} \cdot \left[ \begin{array}{c} 1.7 \\ 0 \\ 1 \\ \end{array} \right]$$
  </li>
  </ul>

q5_1: |
  <h3>PROBLEM 5. Berkeley Forever! <i>(16 pts)</i></h3>
   
  Berkeley, as we all know, is a great place to live. But sometimes people make silly 
  decisions, and move to places on the east coast (say Boston) and get stuck in blizzards. 
  But of course once they move to the east coast, they quickly realize the futility of the 
  endeavor and try to come back to Berkeley as soon as possible. We would like to 
  understand the steady state populations in Beautiful Berkeley versus Blizzardy Boston. 
  Let us assume that people only move back and forth between Berkeley and Boston and 
  don’t move anywhere else.<br/><br/>
   
  Every month, people make the decision to either stay in the same place or move to a new 
  place. In a given month, 80% will continue to stay in Berkeley, but there is a 20% chance 
  that they will choose to move to Boston. For every person in Boston, there is only a 10% 
  chance they will choose to stay in Boston, but 90% will choose to move to Berkeley.<br/><br/>

  a) <i>(3 pts)</i> Draw a graph that models this setup. The nodes in the graph are Berkeley 
  and Boston, and the arcs between the two nodes should be annotated with the 
  probabilities of moving from one node to the other. 

q5_1_s: |
  <img src="/img/sp15q5-1_s.png" class="problem-image" />

q5_2: |
  b) <i>(4 pts)</i> Now let’s say we set up a vector $x(i)$ = ${\left[ \begin{array}{c c} x_{berkeley}(i) & x_{boston}(i) \end{array} \right]}^T$, where $x_{berkeley}(i)$ represents the number of people living in Berkeley at month $i$ (similarly 
  for Boston and $x_{boston}(i)$). Write a matrix $A_{transition}$ that you could multiply by this vector to predict the number of people living in each city at month $i+1$ (i.e., $x(i + 1)$ = $A_{transition}x(i)$)

q5_2_s: |
  $$A_{transition} = \left[ \begin{array}{c c} 0.8 & 0.9 \\ 0.2 & 0.1 \\ \end{array} \right]$$

q5_3: |
  c) <i>(9 pts)</i> Now let us say the total population stays constant, and we start with half 
  the population in Berkeley and the other half in Boston. Use the matrix you wrote 
  above to find the steady-state populations in Berkeley and Boston. If the total 
  population is 100, calculate the number of people in Berkeley at steady state?

q5_3_s: |
  <ul>
  <li>
  Best way to do this is to find the eigenvector of $A_{transition}$ that has an eigenvalue of 1 (we'll next find that there is one).
  </li>
  <li>
  Let's first find the eigenvalues by setting $$det(A_{transition} - \lambda I) = 0$$
  $$\begin{align} det(A_{transition} - \lambda I) &= (0.8 - \lambda)(0.1 - \lambda) - 0.2 \cdot 0.9 \\ &= 0.08 - 0.9 \lambda + \lambda^2 - 0.18 \\ &= \lambda^2 - 0.9\lambda - 0.1 = 0 \end{align}$$
  $$\lambda_{1,2} = \frac{0.9 \pm \sqrt{0.81 + 0.4}}{2} \implies \lambda_1 = 1, \lambda_2 = -0.1$$
  </li>
  <li>
  Now let's find the eigenvector:
  $$A_{transition} \cdot \left[ \begin{array}{c} v_1 \ v_2 \ \end{array} \right] = \left[ \begin{array}{c} v_1 \ v_2 \ \end{array} \right]$$

  $$0.8v_1 + 0.9v_2 = v_1$$
  $$0.2v_1 + 0.1v_2 = v_2$$
  $$v_1 = 4.5v_2$$

  Remember that total population is constant, so we should renormalize the vector such that $v_1 + v_2 = 1$.

  <hr class="s1" />

  Hence $$\left[ \begin{array}{c} v_1 \\ v_2 \\ \end{array} \right] = \left[ \begin{array}{c} \frac{4.5}{5.5} \\ \frac{1}{5.5} \end{array} \right]$$

  So if we started with 100 people, we will end up with ~82 people in Berkeley, and ~18 people in Boston.
  </li>
  </ul>
